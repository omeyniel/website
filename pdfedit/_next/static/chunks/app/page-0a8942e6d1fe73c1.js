(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5786:(e,t,r)=>{Promise.resolve().then(r.bind(r,6165))},6165:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>E});var s=r(5155),a=r(2115);class l{async load(){let e=await Promise.all([r.e(213),r.e(376)]).then(r.bind(r,9139));e.GlobalWorkerOptions.workerSrc=new r.U(r(4215)).toString();let t=await this.file.arrayBuffer();this.pdfDoc=await e.getDocument({data:t}).promise,this.pageCount=this.pdfDoc.numPages}getPageCount(){return this.pageCount}getFileName(){return this.file.name}getFile(){return this.file}getPdfDoc(){return this.pdfDoc}async renderPage(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.5,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!this.pdfDoc)throw Error("PDF not loaded");let a=await this.pdfDoc.getPage(e),l=a.getViewport({scale:r,rotation:s}),n=t.getContext("2d");if(!n)throw Error("Canvas context not available");t.height=l.height,t.width=l.width,await a.render({canvasContext:n,viewport:l}).promise}constructor(e){this.pdfDoc=null,this.pageCount=0,this.file=e}}var n=r(3394);class i{static async splitPDF(e,t){let r=await e.arrayBuffer(),s=await n.PDFDocument.load(r),a=await n.PDFDocument.create();for(let e of t){let[t]=await a.copyPages(s,[e-1]);a.addPage(t)}let l=await a.save(),i=l instanceof Uint8Array?l:new Uint8Array(l);return new Blob([new Uint8Array(i)],{type:"application/pdf"})}static async mergePDFs(e){let t=await n.PDFDocument.create();for(let r of e){let e=await r.arrayBuffer(),s=await n.PDFDocument.load(e);(await t.copyPages(s,s.getPageIndices())).forEach(e=>t.addPage(e))}let r=await t.save(),s=r instanceof Uint8Array?r:new Uint8Array(r);return new Blob([new Uint8Array(s)],{type:"application/pdf"})}static async reorderPDF(e,t){let r=await e.arrayBuffer(),s=await n.PDFDocument.load(r),a=await n.PDFDocument.create();for(let e of t){let[t]=await a.copyPages(s,[e.pageNumber-1]);e.rotation%360!=0&&t.setRotation((0,n.degrees)(e.rotation%360)),a.addPage(t)}let l=await a.save(),i=l instanceof Uint8Array?l:new Uint8Array(l);return new Blob([new Uint8Array(i)],{type:"application/pdf"})}static downloadBlob(e,t){let r=URL.createObjectURL(e),s=document.createElement("a");s.href=r,s.download=t,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}}class c{async addDocument(e){let t=new l(e);return await t.load(),this.documents.push(t),t}getDocuments(){return this.documents}removeDocument(e){this.documents.splice(e,1),this.clearSelectedPages()}moveDocument(e,t){if(e===t||e<0||t<0||e>=this.documents.length||t>=this.documents.length)return;let[r]=this.documents.splice(e,1);this.documents.splice(t,0,r)}clearDocuments(){this.documents=[],this.clearSelectedPages()}togglePageSelection(e,t){let r="".concat(e,"-").concat(t);this.selectedPages.has(r)?this.selectedPages.delete(r):this.selectedPages.add(r)}isPageSelected(e,t){return this.selectedPages.has("".concat(e,"-").concat(t))}getSelectedPages(){return this.selectedPages}clearSelectedPages(){this.selectedPages.clear()}async splitDocument(e,t){let r=this.documents[e];if(!r)throw Error("Document not found");let s=await i.splitPDF(r.getFile(),t),a="".concat(r.getFileName().replace(".pdf",""),"_split.pdf");i.downloadBlob(s,a)}async mergeDocuments(){if(this.documents.length<2)throw Error("Need at least 2 documents to merge");let e=this.documents.map(e=>e.getFile()),t=await i.mergePDFs(e);i.downloadBlob(t,"merged.pdf")}async reorderDocument(e,t){let r=this.documents[e];if(!r)throw Error("Document not found");let s=await i.reorderPDF(r.getFile(),t),a="".concat(r.getFileName().replace(".pdf",""),"_reordered.pdf");i.downloadBlob(s,a)}constructor(){this.documents=[],this.selectedPages=new Set}}var o=r(1786);function d(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter(Boolean).join(" ")}let m=(0,a.forwardRef)((e,t)=>{let{className:r,variant:a="default",size:l="md",...n}=e;return(0,s.jsx)("button",{ref:t,className:d("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:opacity-50 disabled:pointer-events-none",{default:"bg-primary text-primary-foreground hover:bg-primary/90",outline:"border border-border bg-transparent hover:bg-muted",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"bg-transparent hover:bg-muted"}[a],{sm:"h-8 px-3",md:"h-10 px-4"}[l],r),...n})});function u(e){let{className:t,...r}=e;return(0,s.jsx)("div",{className:d("rounded-lg border border-border bg-card text-card-foreground",t),...r})}function h(e){let{onFilesSelected:t,multiple:r=!1,compact:l=!1}=e,n=(0,a.useRef)(null);return(0,s.jsx)(u,{className:"border-2 border-dashed border-border hover:border-primary transition-colors cursor-pointer",onDrop:e=>{e.preventDefault();let r=Array.from(e.dataTransfer.files).filter(e=>"application/pdf"===e.type);r.length>0&&t(r)},onDragOver:e=>{e.preventDefault()},onClick:()=>{var e;return null==(e=n.current)?void 0:e.click()},children:(0,s.jsxs)("div",{className:l?"flex items-center justify-between p-4 gap-4":"flex flex-col items-center justify-center p-12 gap-4",children:[(0,s.jsx)("div",{className:l?"rounded-full bg-primary/10 p-2":"rounded-full bg-primary/10 p-4",children:(0,s.jsx)(o.A,{className:l?"w-5 h-5 text-primary":"w-8 h-8 text-primary"})}),(0,s.jsxs)("div",{className:l?"flex-1":"text-center",children:[(0,s.jsx)("p",{className:l?"text-sm font-medium text-foreground":"text-lg font-medium text-foreground",children:l?"Add more PDFs":"Drop PDF files here or click to browse"}),(0,s.jsx)("p",{className:l?"text-xs text-muted-foreground mt-1":"text-sm text-muted-foreground mt-1",children:r?"Select multiple PDFs to merge":"Select a PDF to split"})]}),(0,s.jsx)(m,{variant:"secondary",type:"button",className:"",children:"Choose Files"}),(0,s.jsx)("input",{ref:n,type:"file",accept:"application/pdf",multiple:r,onChange:e=>{let r=Array.from(e.target.files||[]);r.length>0&&t(r),n.current&&(n.current.value="")},className:"hidden"})]})})}function g(e){let{className:t,checked:r,onCheckedChange:a,...l}=e;return(0,s.jsx)("input",{type:"checkbox",checked:r,onChange:e=>null==a?void 0:a(e.target.checked),className:d("h-4 w-4 rounded border border-border text-primary focus-visible:ring-2 focus-visible:ring-ring",t),...l})}function f(e){let{document:t,docIndex:r,onPageToggle:l,isPageSelected:n,showSelection:i=!1}=e,[c,o]=(0,a.useState)([]),m=(0,a.useRef)(new Map);return(0,a.useEffect)(()=>{o(Array.from({length:t.getPageCount()},(e,t)=>t+1))},[t]),(0,a.useEffect)(()=>{c.forEach(async e=>{let r=m.current.get(e);if(r)try{await t.renderPage(e,r)}catch(t){console.error("Error rendering page ".concat(e,":"),t)}})},[c,t]),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:t.getFileName()}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[c.length," ",1===c.length?"page":"pages"]})]}),(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:c.map(e=>{let t=(null==n?void 0:n(r,e))||!1;return(0,s.jsx)(u,{className:d("relative overflow-hidden transition-all cursor-pointer hover:shadow-lg",t&&"ring-2 ring-primary"),onClick:()=>i&&(null==l?void 0:l(r,e)),children:(0,s.jsxs)("div",{className:"p-2",children:[i&&(0,s.jsx)("div",{className:"absolute top-3 left-3 z-10",children:(0,s.jsx)(g,{checked:t,onCheckedChange:()=>null==l?void 0:l(r,e),className:"bg-background"})}),(0,s.jsx)("canvas",{ref:t=>{t&&m.current.set(e,t)},className:"w-full h-auto"}),(0,s.jsxs)("p",{className:"text-center text-sm text-muted-foreground mt-2",children:["Page ",e]})]})},e)})})]})}m.displayName="Button";var x=r(1360),p=r(2024);function v(){return{toast:e=>{}}}function j(e){let{controller:t}=e,[r,l]=(0,a.useState)(null),[,n]=(0,a.useState)({}),{toast:i}=v(),c=async e=>{try{let r=await t.addDocument(e[0]);l(r),t.clearSelectedPages(),n({})}catch(e){i({title:"Error",description:"Failed to load PDF file",variant:"destructive"})}},o=async()=>{if(!r)return;let e=Array.from(t.getSelectedPages()).filter(e=>e.startsWith("0-")).map(e=>Number.parseInt(e.split("-")[1]));if(0===e.length)return void i({title:"No pages selected",description:"Please select at least one page to extract",variant:"destructive"});try{await t.splitDocument(0,e.sort((e,t)=>e-t)),i({title:"Success",description:"Extracted ".concat(e.length," page(s)")})}catch(e){i({title:"Error",description:"Failed to split PDF",variant:"destructive"})}};return(0,s.jsx)("div",{className:"space-y-6",children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Select Pages to Extract"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(m,{variant:"outline",onClick:()=>{t.clearDocuments(),l(null),n({})},children:[(0,s.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Clear"]}),(0,s.jsxs)(m,{onClick:o,children:[(0,s.jsx)(p.A,{className:"w-4 h-4 mr-2"}),"Extract Selected Pages"]})]})]}),(0,s.jsx)(f,{document:r,docIndex:0,onPageToggle:(e,r)=>{t.togglePageSelection(e,r),n({})},isPageSelected:(e,r)=>t.isPageSelected(e,r),showSelection:!0})]}):(0,s.jsx)(h,{onFilesSelected:c,multiple:!1})})}var w=r(9124),N=r(562),b=r(8803),y=r(5229);function D(e){let{controller:t}=e,[r,l]=(0,a.useState)([]),[,n]=(0,a.useState)({}),{toast:i}=v(),c=async e=>{try{for(let r of e)await t.addDocument(r);l(t.getDocuments()),n({})}catch(e){i({title:"Error",description:"Failed to load PDF files",variant:"destructive"})}},o=async()=>{if(r.length<2)return void i({title:"Not enough files",description:"Please add at least 2 PDF files to merge",variant:"destructive"});try{await t.mergeDocuments(),i({title:"Success",description:"Merged ".concat(r.length," PDF files")})}catch(e){i({title:"Error",description:"Failed to merge PDFs",variant:"destructive"})}},d=(e,r)=>{t.moveDocument(e,"up"===r?e-1:e+1),l(t.getDocuments()),n({})};return(0,s.jsxs)("div",{className:"space-y-6",children:[0===r.length?(0,s.jsx)(h,{onFilesSelected:c,multiple:!0}):null,r.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold text-foreground",children:[r.length," PDF",1!==r.length?"s":""," Ready to Merge"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(m,{variant:"outline",onClick:()=>{t.clearDocuments(),l([]),n({})},children:[(0,s.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Clear All"]}),(0,s.jsxs)(m,{onClick:o,disabled:r.length<2,children:[(0,s.jsx)(w.A,{className:"w-4 h-4 mr-2"}),"Merge PDFs"]})]})]}),(0,s.jsx)("div",{className:"space-y-6",children:r.map((e,a)=>(0,s.jsxs)(u,{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold text-foreground",children:[a+1,". ",e.getFileName()]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>d(a,"up"),disabled:0===a,"aria-label":"Move up",children:(0,s.jsx)(N.A,{className:"w-4 h-4"})}),(0,s.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>d(a,"down"),disabled:a===r.length-1,"aria-label":"Move down",children:(0,s.jsx)(b.A,{className:"w-4 h-4"})}),(0,s.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>{t.removeDocument(a),l(t.getDocuments()),n({})},"aria-label":"Remove",children:(0,s.jsx)(y.A,{className:"w-4 h-4"})})]})]}),(0,s.jsx)(f,{document:e,docIndex:a,showSelection:!1})]},a))}),(0,s.jsx)(h,{onFilesSelected:c,multiple:!0,compact:!0})]})]})}var P=r(3152),F=r(3141);function C(e){let{controller:t}=e,[r,l]=(0,a.useState)(null),[n,i]=(0,a.useState)([]),c=(0,a.useRef)(new Map),[,o]=(0,a.useState)({}),{toast:d}=v(),g=async e=>{try{let r=await t.addDocument(e[0]);l(r),i(Array.from({length:r.getPageCount()},(e,t)=>({pageNumber:t+1,rotation:0}))),o({})}catch(e){d({title:"Error",description:"Failed to load PDF file",variant:"destructive"})}};(0,a.useEffect)(()=>{r&&n.forEach(async e=>{let t=c.current.get(e.pageNumber);if(t)try{await r.renderPage(e.pageNumber,t,.9,e.rotation)}catch(t){console.error("Error rendering page ".concat(e.pageNumber,":"),t)}})},[n,r]);let f=(e,t)=>{let r="up"===t?e-1:e+1;if(r<0||r>=n.length)return;let s=[...n],[a]=s.splice(e,1);s.splice(r,0,a),i(s)},p=async()=>{if(r)try{await t.reorderDocument(0,n),d({title:"Success",description:"Reordered PDF downloaded"})}catch(e){d({title:"Error",description:"Failed to reorder PDF",variant:"destructive"})}};return(0,s.jsx)("div",{className:"space-y-6",children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Reorder Pages"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(m,{variant:"outline",onClick:()=>{t.clearDocuments(),l(null),i([]),o({})},children:[(0,s.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Clear"]}),(0,s.jsxs)(m,{onClick:p,children:[(0,s.jsx)(P.A,{className:"w-4 h-4 mr-2"}),"Download Reordered PDF"]})]})]}),(0,s.jsx)("div",{className:"space-y-4",children:n.map((e,t)=>(0,s.jsxs)(u,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["#",t+1]}),(0,s.jsxs)("div",{className:"text-sm font-medium text-foreground",children:["Page ",e.pageNumber]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>f(t,"up"),disabled:0===t,"aria-label":"Move up",children:(0,s.jsx)(N.A,{className:"w-4 h-4"})}),(0,s.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>f(t,"down"),disabled:t===n.length-1,"aria-label":"Move down",children:(0,s.jsx)(b.A,{className:"w-4 h-4"})}),(0,s.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>{i(e=>e.map((e,r)=>r===t?{...e,rotation:(e.rotation+90)%360}:e))},"aria-label":"Rotate right",children:(0,s.jsx)(F.A,{className:"w-4 h-4"})}),(0,s.jsx)(m,{variant:"ghost",size:"sm",onClick:()=>{i(e=>e.filter((e,r)=>r!==t))},"aria-label":"Remove page",children:(0,s.jsx)(x.A,{className:"w-4 h-4"})})]})]}),(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)("canvas",{ref:t=>{t&&c.current.set(e.pageNumber,t)},className:"w-full h-auto"})})]},"".concat(e.pageNumber,"-").concat(t)))})]}):(0,s.jsx)(h,{onFilesSelected:g,multiple:!1})})}var S=r(3341);function k(){return null}let A=new c;function E(){let[e,t]=(0,a.useState)("split"),[r,l]=(0,a.useState)(!1),n=e=>{A.clearDocuments(),t(e)};return(0,a.useEffect)(()=>{let e=()=>{l(window.scrollY>40)};return e(),window.addEventListener("scroll",e,{passive:!0}),()=>window.removeEventListener("scroll",e)},[]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("header",{className:"site-header pdfedit-header".concat(r?" shrunk":""),children:[(0,s.jsx)("div",{className:"container header-row",children:(0,s.jsxs)("div",{className:"brand",children:[(0,s.jsx)("img",{src:"/assets/logo.jpg",alt:"meyniel.ca",className:"logo",onError:e=>e.currentTarget.style.display="none"}),(0,s.jsxs)("div",{className:"brand-text",children:[(0,s.jsx)("h1",{children:"PDF Editor"}),(0,s.jsx)("p",{className:"subtitle",children:"Split PDFs by extracting pages or merge multiple PDFs into one"})]})]})}),(0,s.jsxs)("nav",{className:"container nav",children:[(0,s.jsx)("a",{href:"/index.html",children:"Accueil"}),(0,s.jsx)("a",{href:"/darwin.html",children:"Darwin"}),(0,s.jsx)("a",{href:"/tetris/",className:"tool-link",children:"\uD83C\uDFAE Tetris"})]})]}),(0,s.jsxs)("main",{className:"min-h-screen bg-background",children:[(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)("div",{className:"pdfedit-divider"}),(0,s.jsxs)("div",{className:"flex gap-2 mb-8",children:[(0,s.jsxs)(m,{variant:"split"===e?"default":"outline",onClick:()=>n("split"),className:"flex-1 sm:flex-none",children:[(0,s.jsx)(p.A,{className:"w-4 h-4 mr-2"}),"Split PDF"]}),(0,s.jsxs)(m,{variant:"merge"===e?"default":"outline",onClick:()=>n("merge"),className:"flex-1 sm:flex-none",children:[(0,s.jsx)(w.A,{className:"w-4 h-4 mr-2"}),"Merge PDFs"]}),(0,s.jsxs)(m,{variant:"reorder"===e?"default":"outline",onClick:()=>n("reorder"),className:"flex-1 sm:flex-none",children:[(0,s.jsx)(S.A,{className:"w-4 h-4 mr-2"}),"Edit PDF"]})]}),"split"===e?(0,s.jsx)(j,{controller:A}):"merge"===e?(0,s.jsx)(D,{controller:A}):(0,s.jsx)(C,{controller:A})]}),(0,s.jsx)(k,{})]})]})}}},e=>{e.O(0,[198,441,255,358],()=>e(e.s=5786)),_N_E=e.O()}]);